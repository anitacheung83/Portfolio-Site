<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- bootstrap link below -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <!-- Google font below -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Quicksand&display=swap"
        rel="stylesheet">
    <!-- css stylesheet below -->
    <link rel="stylesheet" href="css/league.css">
    <!-- favicon outer below -->
    <link rel="icon" href="images/favicon.ico?">
    <title>League Statistic Bot</title>
</head>

<body>
    <div>
        <ul class="navbar-s">
            <li class="nav-item-s nav-item-left"><a href="#"><img src="/images/android-chrome-512x512.png" width="30">
                    Project: League Statistic Bot</a></li>
            <li class="nav-item-s nav-item-right"><a href="/index.html#contact">Contact</a></li>
            <li class="nav-item-s nav-item-right"><a href="/index.html#projects">Projects</a></li>
            <li class="nav-item-s nav-item-right"><a href="/index.html#aboutMe">About</a></li>
            <li class="nav-item-s nav-item-right"><a href="/index.html">Home</a></li>
        </ul>
    </div>

    <div class="container">
        <h1><span class="highlight-title">League Statistic Discord Bot</span></h1>


        <div class="row outer">
            <div class="col-sm-8">
                <h2>Preface</h2>
                <p>Initially, I developed the League Statistic Bot with the intention to improve communication with
                    my
                    boyfriend. One of the challenges we face was the timing of my calls, particularly when my
                    boyfriend was in a game of League of Legend. Understandably, interrupting him during those moments
                    would lead to frustration, and he humorously jokes that I shouldn't call him when he is "at war".
                    Thus, I sought
                    a solution that would allow me to determine if he was currently playing League. By implementing the
                    League
                    Statistic Bot, I can now know if my boyfriend is playing League at the moment. Which enables me to
                    wait
                    until after his game to reach out, ensuring our conversations are more enjoyable and uninterrupted.
                </p>
                <h4>Further Application</h4>
                <p>League Statistic Bot has also become a helpful tool for my family, especially when it comes to my
                    younger
                    brother's gaming habits. He struggles with self-control and to manage his gaming time
                    properly. So,
                    my
                    parents started using the bot to keep track of his playtime and help him with time management.
                    It's made
                    a
                    significant difference in his academic performance. With the bot's support, my parents can
                    better guide
                    him
                    and find a balance between gaming and his studies. It's been a positive intervention that's
                    created a
                    more
                    supportive environment for his growth and success.</p>
            </div>

            <div class="col-sm-4">
                <img src="images/slash-command.png" alt="slash command" height="600">
            </div>
        </div>


        <div>
            <h2>Description</h2>

            <p>The League Statistic Bot is a Discord bot designed to fetch League of Legend game data using the
                <a class="inline" href="https://developer.riotgames.com/apis"> Riot Games API.</a>
                It utilizes Discord's slash commands feature to provide users with convenient ways to track
                summoner's
                games.
            </p>

            <p>Users can check if a summoner is currently playing League of Legends by using the <span
                    class="slash">/active</span> slash command.
            </p>

            <div class="outer">
                <img src="images/league-bot-past.png" alt="past slash command" height="600">
            </div>

            <p>Moreover, users can request the data for the summoner's past 10 games by using <span
                    class="slash">/past</span> slash command.</p>

            <div class="outer">
                <img src="images/league-bot-past.png" alt="past slash command" height="600">
            </div>

            <p>Additionally, the bot generates two bar graphs by <a class="inline"
                    href="https://matplotlib.org/stable/tutorials/index.html">matplotlib</a>. The first graph displays
                the total time
                played
                by the summoner last week, allowing users to visualize their gaming activity over time. The second graph
                shows
                the total number of games played by the summoner last week, providing insights into their gaming
                frequency.</p>

            <div class="outer">
                <img src="images/total_time_played_graph.png" alt="graph" height="400">
                <img src="images/games_played_graph.png" alt="graph" height="400">
            </div>
            <p>Lastly, the bot generates a comprehensive weekly report that includes a list of games played by the
                summoner previous week and total time played graph and number of games played graph.</p>
        </div>

        <h2>Code:</h2>
        <p class="inline-code">The code can be divided into 3 components. The first component, <span
                class="highlight">discord</span>, is responsible for receiving commands and sending responses on
            Discord. It consists of two files,
        <pre class="inline-code">discord_bot.py</pre> and
        <pre class="inline-code">responses.py</pre>.
        The second component, <span class="highlight">riot request</span>, is responsible for fetching data from Riot
        API. It comprises of the file
        <pre class="inline-code">riot_requests.py"</pre>. The third component <span class="highlight">entity</span>
        includes four files:
        <pre class="inline-code">summoner.py</pre>,
        <pre class="inline-code">team.py</pre>,
        <pre class="inline-code">match.py</pre>,
        <pre class="inline-code">weekly_report.py</pre>.
        <br />
        Clean Architecture
        </p>
        <div>
            <h4>
                Discord:
                <pre class="inline-code">discord_bot.py</pre> &
                <pre class="inline-code">requests.py</pre>
            </h4>

            <p class="inline-code">
                The discord session of the code handles user requests and sending corresponding responses to
                user. In the file
            <pre class="inline-code">discord_bot.py</pre>, <a class="inline"
                href="https://discordpy.readthedocs.io/en/stable/">discord.py</a> library
            is used to aid in creating the application that utilize the Discord API. By utilizing
            <pre class="inline-code">client.tree.command</pre> decorator from <a class="inline"
                href="https://discordpy.readthedocs.io/en/stable/">discord.py</a>, we can create
            slash commands that users can use on Discord. Each command invokes
            a corresponding function from
            <pre class="inline-code">responses.py</pre> then uses
            <pre class="inline-code">discord.Interaction</pre> to send the responses to users (as shown below).
            </p>

            <pre>
    @client.tree.command(name="active")
    @app_commands.describe(summoner_name="Summoner Name")
    async def active(interaction: discord.Interaction, summoner_name: str) -> None:
        """
        Sends a message to the user with the active game of the summoner

        Args:
            interaction (discord.Interaction): The Discord interaction object representing the original message
            summoner_name (str): The summoner name

        Returns:
            None
        """
        active_game = responses.active(summoner_name)
        await interaction.response.send_message(active_game)
            </pre>

            <p> 'responses.py' calls the corresponding function in 'riot_requests.py', that fetch the required data from
                riot api.
                which, in turn, calls the corresponding
                function in ‘riot_requests.py’,
                that fetch the required data from riot api.


            </p>
            <pre>
    def active(summoner_name: str) -> str:
        """
        Return a string of active game information given summoner_name.

        Args:
            summoner_name (str): summoner name

        Returns:
            active_game (str): a string of active game information
        """
        summoner = riot_requests.get_summoners_by_name(summoner_name)

        active_game = riot_requests.get_active_games_by_summoner_id(summoner.id)

        return str(active_game)
            </pre>
        </div>

        <div>
            <h4>
                Riot Request:
                <pre class="inline-code">riot_requests.py</pre>
            </h4>
        </div>

        <div>
            <h4>Other classes</h4>
            <p>
                The Match class represents an individual game match in League of Legends. It contains attributes such as
                the match ID, start time, duration, and participating teams. It serves as a data transfer object (DTO)
                for storing match-related information.
                The Summoner class represents a League of Legends summoner. It contains attributes such as the summoner
                ID, name, level, and game statistics. It acts as a DTO for storing summoner-related data.
                The WeeklyReport class generates a report summarizing the summoner's activity in the previous week. It
                interacts with the Match and Summoner classes to gather the necessary data and produces visualizations,
                such as graphs depicting the total time played and total games played.
                the Team class, which represents a team in a League of Legends match. The Team class is a data transfer
                object (DTO) used to store information about a team, including its ID, list of participants (players),
                and the outcome of the team (win or loss).
            </p>
            <h6>Architecture Diagram:</h6>
            <iframe src="league-statistic-bot-architecture-diagram.html" width="1200" height="700"
                frameborder="0"></iframe>
        </div>


        <div>

        </div>



        <div>
            <h2>Testing: PyTest</h2>
            <h3>riot_requests_test</h3>
            <p>The "riot_requests_test" suite validates the functionality of Riot API calls in an ever-changing API
                environment. Using pytest.fixture, the tests are set up with mock API responses from JSON files. By
                utilizing with patch("requests.get"), the actual requests.get function is replaced with a mock response.
                This approach ensures that the code correctly interacts with the Riot API, accommodating potential API
                changes. The mock responses create a stable testing environment where the application's behavior can be
                verified against expected outcomes. Through these tests, the reliability of Riot API integration is
                maintained, promptly identifying and resolving any issues. The ultimate goal is to deliver a robust
                application that seamlessly interacts with the evolving Riot API, ensuring a consistent and dependable
                user experience.</p>
            <pre>
        @pytest.fixture
        def mock_get_summoners_by_name_sucess():
            with open("test/mock_get_summoners_by_name_success.json") as f:
                return json.load(f)


        def test_get_summoners_by_name_success(mock_get_summoners_by_name_sucess):
            """
            Test get_summoners_by_name() with a valid summoner name.
            """

            summoner_name = "Kid Orpheus"
            with patch("requests.get") as mock_get:
                mock_get.return_value.json.return_value = mock_get_summoners_by_name_sucess
                summoner = get_summoners_by_name(summoner_name)

            assert expected_summoner == summoner
            </pre>
            <h3>discord_bot_test</h3>
            <p></p>
        </div>

        <div>
            <h2>Hosting</h2>
            <p>
                Originally, the bot was hosted on Heroku, but recently they started charging $7 per month for command
                line
                access. Fortunately, I received a generous gift from my dad in the form of a Raspberry Pi. Now, the bot
                is
                hosted on my Raspberry Pi, allowing me to run it for free.
            </p>
            <img src="/images/pironman.jpeg" height="400" />
        </div>

        <!-- <div>
            <h2>What I've Learned</h2>
        </div>

        <div>
            <h2>Hurdles</h2>
        </div> -->

        <div>
            <h2>References</h2>
            <ul>
                <li>
                    <a href="
                    https://www.youtube.com/playlist?list=PLL34mf651faNqwhZEM91zU3c-dcc4dLF0">PyTest Tutorial</a>
                </li>
                <li>
                    <a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html">Uncle Bob:
                        The Clean Architecture</a>
                </li>
            </ul>
        </div>

        <div>
            <h2>Upcoming</h2>
        </div>
    </div>

</body>

</html>